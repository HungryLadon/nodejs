var pokedexNumberToName = require('./pokedex-number-to-name');
var pokemonNameToNumber = require('./pokemon-name-to-number');

var baseUrl = 'http://www.pokestadium.com/sprites/xy/';
var shinyUrl = 'http://www.pokestadium.com/sprites/xy/shiny/';
var extension = '.gif';

function getGifByPokedexNumber(pokedexNumber) {
  if (pokedexNumberToName.hasOwnProperty(pokedexNumber)) {
    var pokemonUrlName = pokedexNumberToName[pokedexNumber]
      .toString()
      .replace(/\./g,'')
      .replace(/'/g,'')
      .replace(/\s/g, "-");

    return baseUrl + pokemonUrlName + extension;
  } else {
    throw new Error('Invalid pokedex number ' +  pokedexNumber);
  }
}

function getShinyGifByPokedexNumber(pokedexNumber) {
  if (pokedexNumberToName.hasOwnProperty(pokedexNumber)) {
    var pokemonUrlName = pokedexNumberToName[pokedexNumber]
      .toString()
      .replace(/\./g,'')
      .replace(/'/g,'')
      .replace(/\s/g, "-");

    return shinyUrl + pokemonUrlName + extension;
  } else {
    throw new Error('Invalid pokedex number ' +  pokedexNumber);
  }
}

function getShinyGifByPokemonName(pokemonName) {
  var lowercasePokemonName = pokemonName.toLowerCase();

  if (pokemonNameToNumber.hasOwnProperty(lowercasePokemonName)) {
    var pokemonUrlName = lowercasePokemonName
      .replace(/\./g,'')
      .replace(/'/g,'')
      .replace(/\s/g, "-");

    return shinyUrl + pokemonUrlName + extension;
  } else {
     
    throw new Error('Invalid pokemon name ' + pokemonName);
  }
}

function getGifByPokemonName(pokemonName) {
  var lowercasePokemonName = pokemonName.toLowerCase();

  if (pokemonNameToNumber.hasOwnProperty(lowercasePokemonName)) {
    var pokemonUrlName = lowercasePokemonName
      .replace(/\./g,'')
      .replace(/'/g,'')
      .replace(/\s/g, "-");

    return baseUrl + pokemonUrlName + extension;
  } else {
     
    throw new Error('Invalid pokemon name ' + pokemonName);
  }
}

function pokemonGif(identifier, isShiny) {
  if (typeof identifier === 'string' && isShiny === false) {
    return getGifByPokemonName(identifier);
  } else if (typeof identifier === 'number' && isShiny === false) {
    return getGifByPokedexNumber(identifier);
  } else if (typeof identifier === 'string' && isShiny === true){
    return getShinyGifByPokemonName(identifier);
  }else if(typeof identifier ==='number' && isShiny === true){
    return getShinyGifByPokedexNumber(identifier);
  }else{
    throw new TypeError('pokemonGif input must be type string or number and a shiny boolean');
  }
}

module.exports = pokemonGif;
